---
title: "NEON Comparing one to three pass fish estimates"
author: "Jeff Wesner"
format: docx
editor: visual
---

NEON currently estimates fish population sizes using three-pass depletion methods at each stream site twice per year. To assess how changing NEON assessments to a single pass would alter inferences about fish populations, we compared population estimates from the three-pass data with population estimates from a single pass data. Single-pass data was corrected for detection probabilities (derived from the 3-pass method).

**Approach**

We obtained 292 collections from repeated 3-pass depletion electrofishing at 23 NEON wadeable stream sites. The dates ranged from April 2016 to November 2021. Each collection consists of the total number of fish collected in each of three passes per site per date. NEON reports fish data in two tables: one for fish that are measured for length, and one for fish that are bulk counted. In this study, both datasets were added together to represent the total number of fish collected during each electrofishing bout.

To estimate fish population sizes, we used three methods. First, we estimated the population size from each of the 292 3-pass collections using the Carl-Straub method within the *FSA* package in R. Second, we re-ran the 3-pass analysis using a Bayesian multinomial Poisson (Royle 2004) model within the *ubms* package. Third, we limited the dataset to just the first pass and then fit a Poisson model with site-specific probability of detection *p* as an offset. This model adjusts counts from the first pass for the probability of detection, thereby providing an estimate of the total population size with a single pass (Glover et al. 2019).

**Results**

*Abundance*

The figure below shows all 292 estimates from each of the three statistical methods, ranked by their total abundance. All three methods show close matches with the exception of a small number of sites. Closer inspection suggests that those sites with mis-matches likely contain a large number of fish in the 2nd or 3rd pass. That affects \<2% of the 292 samples.

```{r}
library(here)
readRDS(here("code/fish/models/test_data/method_comparison.rds"))
```

Similarly, the figure below directly compares estimates from the single pass model with matching estimates from the three-pass Bayesian model. The black line is the 1:1 line. When more than about 20 fish are collected, the population estimates match almost exactly. Something to consider in these models is that the probability of detection is very high (typically \>0.95), because most samples reach depletion by the first pass.

```{r}
library(here)
readRDS(here("code/fish/models/test_data/regress_three_one.rds"))
```

*Richness*

An additional concern is whether rare fish might be missed in sample with only a single pass. To test that, we compared the total richness in each of the 292 collections between the single and three-pass datasets. The figure below shows the comparison. It indicates that total species richness is identical between the methods. In other words, while some fish were caught on the 2nd or 3rd pass, all species present were always included in the first pass. (Note that each dot below represents multiple samples, since richness is an integer.)

```{r}
library(here)
readRDS(here("code/fish/models/test_data/methods_compare_richness.rds"))
```

**To do**

Re-run the abundance models above for species-specific estimates, rather than total abundance.

Simulate to reflect different scenarios of future sampling (e.g., three-pass depletion once per year vs once every two or five years).

Plot detection probability over time
